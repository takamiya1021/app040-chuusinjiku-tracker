# 要件定義書 v1.0
## 中心軸を整える習慣化アプリ

**作成日**: 2025-10-19
**プロジェクト名**: 中心軸トラッカー（仮）
**バージョン**: 1.0

---

## 1. プロジェクト概要

### 1.1 目的
メンタルを整えることで心身のバランスを取り戻し、最終的に人生のレベルを上げることを支援する読み物アプリ。

### 1.2 ターゲットユーザー
- **主要ユーザー**: 人生がうまくいっていないと感じている人
- **利用形態**: 一般公開（あおいさん個人も使用）

### 1.3 コアコンセプト
- 心に響く文章を毎日1つずつ読む
- 強制や義務感を排除した、自発的な習慣形成
- シンプルで美しい読書体験

---

## 2. 機能要件

### 2.1 コアフロー
1. アプリを開くと、今日の文章がすぐに表示される
2. ユーザーは文章を読む
3. 読了後、任意で「読んだ」チェックをつける
4. 過去の文章にも自由にアクセス可能

### 2.2 必須機能

#### 2.2.1 文章表示機能
- **コンテンツ量**: 500〜700記事（約2年分）
- **文章長**: 1,000〜3,000文字程度
- **表示方式**: ランダム表示（デフォルト）
- **メタデータ**: 各文章に日付とカテゴリータグを付与
- **フィルター機能**: カテゴリーや日付でフィルタリング可能（後々実装）

#### 2.2.2 チェック機能
- **読了チェック**: 「読んだ」マークを簡易的につけられる
- **履歴保存**: ローカルストレージに保存
- **統計機能**: 不要（履歴データのみ保持）

#### 2.2.3 ナビゲーション機能
- **メニュー**: ホーム・カテゴリーの2ページ構成
  - ホーム: ランダムに1記事表示
    - 「次の記事」ボタンクリック時: 画面をトップまでスムーズにスクロール
  - カテゴリー: 全記事一覧（カテゴリー別フィルター可能）
- **文章一覧**: カテゴリーページで全記事表示
  - 記事タイトルクリックで本文展開/折りたたみ
  - 記事番号表示（日付古い順に1, 2, 3...）
  - ソート順: 各カテゴリ内でお気に入り優先 → 番号昇順
- **検索機能**: 将来的に実装検討
- **アーカイブページ**: カテゴリーページに統合したため削除

#### 2.2.4 オフライン対応
- 全文章データをローカルに保存
- インターネット接続なしでも利用可能

### 2.3 除外機能
- ❌ リマインダー通知
- ❌ 進捗可視化（グラフ、統計）
- ❌ 達成率の表示
- ❌ ソーシャル機能

---

## 3. データ要件

### 3.1 データソース
- **元データ**: Gmail（2年分、500〜700通のメール）
- **収集方法**: Gmail API または MCP経由で取得
- **前処理**: AI要約により読みやすい形式に加工

### 3.1.1 2バージョン対応（重要）
- **自分用（プライベート版）**: 元メール本文をそのまま使用
  - ファイル名: `articles-private.json`
  - 用途: あおいさん個人利用
  - 処理: 軽微な整形のみ（カテゴリー・タイトル付与）

- **公開用（パブリック版）**: 著作権対策済み要約版
  - ファイル名: `articles-public.json`
  - 用途: 一般公開
  - 処理: AI要約により完全再構成

### 3.1.2 著作権対策（公開用のみ適用）
- **要約方針**: 元の表現をそのまま使用せず、内容・メッセージの本質を保ちつつ一般的な表現に変換
- **目的**: 著作権問題の回避
- **具体的手法**:
  - 固有の言い回しや独自の表現を避ける
  - 伝えたい本質的なメッセージ・教訓を抽出
  - 一般的でわかりやすい日本語に書き直す
  - 引用ではなく「再構成」として作成
- **品質基準**:
  - ✅ 元の内容の本質的なメッセージが伝わる
  - ✅ オリジナルの表現とは異なる文章構成
  - ✅ 読者にとって理解しやすい一般的な表現

### 3.1.3 バージョン切り替え設計
- **切り替え方法**: データファイルの入れ替えのみ
- **実装方針**:
  - アプリコードは同一
  - `public/articles.json` のファイルを差し替えるだけで動作
  - ビルド時に環境変数でどちらを使用するか選択可能
- **デプロイ戦略**:
  - プライベート版: ローカル環境のみ
  - パブリック版: Vercel等の公開環境にデプロイ

### 3.2 データ構造
各文章には以下のメタデータを付与：
```json
{
  "id": "unique-id",
  "title": "タイトル（要約から生成）",
  "content": "要約済み本文",
  "category": "カテゴリー名",
  "date": "YYYY-MM-DD",
  "originalDate": "元メールの日付",
  "createdAt": "ISO 8601形式",
  "tags": ["タグ1", "タグ2"],
  "number": "通し番号（日付昇順で自動採番、表示時に動的付与）",
  "hidden": "非表示フラグ（true: どこにも表示しない、オプション）"
}
```

**注**:
- `readStatus`と`readAt`はローカルストレージで管理（データファイルには含めない）
- `number`は表示時に動的に採番される（データファイルには含まれない場合あり）
- `hidden`が`true`の記事はアプリ内のどこにも表示されない

### 3.3 ローカルストレージ
- **保存データ**: 全文章データ + 読了履歴
- **技術**: LocalStorage または IndexedDB
- **容量見積もり**: 約3MB〜5MB（500記事 × 平均3,000文字想定）

---

## 4. 技術要件

### 4.1 プラットフォーム
- **種類**: Webアプリケーション
- **対応デバイス**: PC、スマートフォン、タブレット
- **ブラウザ対応**: モダンブラウザ（Chrome, Firefox, Safari, Edge）

### 4.2 技術スタック（推奨）
- **フレームワーク**: Next.js 14.x（App Router）
- **UI**: React 18.x
- **スタイリング**: Tailwind CSS v3 + Framer Motion（アニメーション）
- **データ管理**: Context API または Zustand
- **ストレージ**: LocalStorage / IndexedDB

### 4.3 オフライン対応
- Service Worker または Next.js の Static Export
- 全データの事前ロード

### 4.4 パフォーマンス要件
- 初回ロード: 3秒以内
- 画面遷移: 0.5秒以内（アニメーション含む）
- スムーズなアニメーション（60fps維持）

---

## 5. デザイン要件

### 5.1 デザイン方針
- **シンプル**: 余計な要素を排除
- **美しい**: 視覚的に心地よい体験
- **読みやすい**: テキスト可読性を最優先

### 5.2 具体的要件
- **カラーテーマ**: 落ち着いた配色
- **フォント**: 読みやすさ重視（明朝体 or ゴシック体）
- **背景**: シンプル（装飾特になし）
- **アニメーション**: 画面切り替え時に美しいトランジション

### 5.3 UI/UX
- **レスポンシブデザイン**: モバイルファースト
- **タップ領域**: モバイルで操作しやすいサイズ
- **スクロール**: 長文でもストレスなく読める

---

## 6. 非機能要件

### 6.1 セキュリティ
- ユーザーデータはローカルのみ保存
- 外部送信なし（プライバシー保護）

### 6.2 アクセシビリティ
- キーボード操作対応
- 適切なフォントサイズ（拡大可能）

### 6.3 保守性
- コードの可読性重視
- コンポーネント分割による再利用性

---

## 7. データ収集フロー（要検討事項）

### 7.1 Gmail データ収集方法の候補

#### 案1: Gmail API（推奨）
- Google Cloud Platformでプロジェクト作成
- Gmail API有効化
- OAuth 2.0認証
- メール一覧取得 → 本文抽出
- **メリット**: 公式API、安定性高
- **デメリット**: 初期設定が必要

#### 案2: MCP経由
- MCP Gmail Serverの利用（存在する場合）
- **メリット**: 設定が簡易
- **デメリット**: MCPサーバーの有無に依存

#### 案3: 手動エクスポート
- Gmail検索でメール抽出
- mbox形式でエクスポート
- Pythonスクリプトで解析
- **メリット**: APIキー不要
- **デメリット**: 手動作業

### 7.2 要約処理
- 収集した長文メールをAI要約（Gemini/Claude）
- 1,000〜3,000文字に整形
- カテゴリー自動分類（または手動）

---

## 8. スケジュール

### 8.1 完成目標
- **期限**: 1週間以内（2025-10-26まで）

### 8.2 リリース方針
- 段階的リリースなし
- 完成次第即公開

### 8.3 フェーズ想定
1. **データ収集**: Gmail → 要約 → JSON化（2〜3日）
2. **アプリ開発**: UI実装 + 機能実装（3〜4日）
3. **テスト・調整**: デザイン調整、動作確認（1日）

---

## 9. 成功基準

### 9.1 機能面
- ✅ 500記事以上が表示可能
- ✅ オフラインで動作
- ✅ モバイルで快適に読める
- ✅ 読了チェックが正常に動作

### 9.2 体験面
- ✅ 開いてすぐ文章が読める（3秒以内）
- ✅ 画面遷移が美しい（アニメーション）
- ✅ 長文でもストレスなく読める
- ✅ シンプルで心地よいデザイン

---

## 10. 今後の拡張可能性（v2以降）

- カテゴリーフィルター機能の充実
- お気に入り機能
- メモ・感想記録機能
- 検索機能
- 読書統計の可視化（オプション）
- PWA化（ホーム画面追加）

---

## 11. カテゴリー管理

### 11.1 表示カテゴリー（7種類、1,153件）
- マインドセット（371件）
- 行動力（275件）
- 自己受容（165件）
- 目標設定（131件）
- 習慣形成（100件）
- 人間関係（82件）
- 感謝（29件）

### 11.2 非表示カテゴリー（4種類、5件）
以下のカテゴリーは`hidden: true`フラグが設定され、アプリ内のどこにも表示されません：
- お知らせ（2件）
- イベント告知（1件）
- 情報共有（1件）
- 販売会案内（1件）

**理由**: 読み物としての価値が低く、メンタル整理の目的に合わないため非表示化

---

## 12. 補足事項

### 12.1 制約事項
- データ収集の方法は要相談・要検証
- Gmail APIの利用制限に注意

### 12.2 想定リスク
- Gmail API設定の複雑さ
- 要約処理の時間・コスト
- データ量が大きい場合のパフォーマンス

---

**承認**: □ あおいさん
**作成者**: クロ
**次のステップ**: Gmail収集方法の選定 → 技術設計書作成
